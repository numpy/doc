

<!DOCTYPE html>


<html lang="en" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>F2PY and Windows &#8212; NumPy v1.25 Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/numpy.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'f2py/windows/index';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://numpy.org/doc/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.25';
        </script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="F2PY and Windows Intel Fortran" href="intel.html" />
    <link rel="prev" title="F2PY test suite" href="../f2py-testing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
    
    <img src="../../_static/numpylogo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/numpylogo_dark.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../user/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../reference/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev/index.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release.html">
                        Release notes
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://numpy.org/numpy-tutorials/">
                    Learn
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      1.25  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/numpy/numpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/numpy_team" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../user/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../reference/index.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../dev/index.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release.html">
                        Release notes
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://numpy.org/numpy-tutorials/">
                    Learn
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      1.25  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/numpy/numpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/numpy_team" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../user/whatisnumpy.html">What is NumPy?</a></li>
<li class="toctree-l1"><a class="reference external" href="https://numpy.org/install/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/quickstart.html">NumPy quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals and usage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../user/basics.html">NumPy fundamentals</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../user/numpy-for-matlab-users.html">NumPy for MATLAB users</a></li>
<li class="toctree-l1"><a class="reference external" href="https://numpy.org/numpy-tutorials/features.html">NumPy Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/howtos_index.html">NumPy how-tos</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced usage and interoperability</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../user/building.html">Building from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/c-info.html">Using NumPy C-API</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">F2PY user guide and reference manual</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../f2py.getting-started.html">Three ways to wrap - getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../f2py-user.html">F2PY user guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../f2py-reference.html">F2PY reference manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html">Using F2PY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-usage.html">Using F2PY bindings in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signature-file.html">Signature file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../buildtools/index.html">F2PY and Build Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced.html">Advanced F2PY use cases</a></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">F2PY and Windows</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="intel.html">F2PY and Windows Intel Fortran</a></li>
<li class="toctree-l3"><a class="reference internal" href="msys2.html">F2PY and Windows with MSYS2</a></li>
<li class="toctree-l3"><a class="reference internal" href="conda.html">F2PY and Conda on Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="pgi.html">F2PY and PGI Fortran on Windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/underthehood.html">Under-the-hood documentation for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/basics.interoperability.html">Interoperability with NumPy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">NumPy license</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../user/index.html" class="nav-link">NumPy user guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">F2PY user guide and reference manual</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">F2PY and Windows</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="f2py-and-windows">
<span id="f2py-windows"></span><h1>F2PY and Windows<a class="headerlink" href="#f2py-and-windows" title="Permalink to this heading">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>F2PY support for Windows is not at par with Linux support, and
OS specific flags can be seen via <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">numpy.f2py</span></code></p>
</div>
<p>Broadly speaking, there are two issues working with F2PY on Windows:</p>
<ul class="simple">
<li><p>the lack of actively developed FOSS Fortran compilers, and,</p></li>
<li><p>the linking issues related to the C runtime library for building Python-C extensions.</p></li>
</ul>
<p>The focus of this section is to establish a guideline for developing and
extending Fortran modules for Python natively, via F2PY on Windows.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>From a user perspective, the most UNIX compatible Windows
development environment is through emulation, either via the Windows Subsystem
on Linux, or facilitated by Docker. In a similar vein, traditional
virtualization methods like VirtualBox are also reasonable methods to develop
UNIX tools on Windows.</p>
<p>Native Windows support is typically stunted beyond the usage of commercial compilers.
However, as of 2022, most commercial compilers have free plans which are sufficient for
general use. Additionally, the Fortran language features supported by <code class="docutils literal notranslate"><span class="pre">f2py</span></code>
(partial coverage of Fortran 2003), means that newer toolchains are often not
required. Briefly, then, for an end user, in order of use:</p>
<dl>
<dt>Classic Intel Compilers (commercial)</dt><dd><p>These are maintained actively, though licensing restrictions may apply as
further detailed in <a class="reference internal" href="intel.html#f2py-win-intel"><span class="std std-ref">F2PY and Windows Intel Fortran</span></a>.</p>
<p>Suitable for general use for those building native Windows programs by
building off of MSVC.</p>
</dd>
<dt>MSYS2 (FOSS)</dt><dd><p>In conjunction with the <code class="docutils literal notranslate"><span class="pre">mingw-w64</span></code> project, <code class="docutils literal notranslate"><span class="pre">gfortran</span></code> and <code class="docutils literal notranslate"><span class="pre">gcc</span></code>
toolchains can be used to natively build Windows programs.</p>
</dd>
<dt>Windows Subsystem for Linux</dt><dd><p>Assuming the usage of <code class="docutils literal notranslate"><span class="pre">gfortran</span></code>, this can be used for cross-compiling
Windows applications, but is significantly more complicated.</p>
</dd>
<dt>Conda</dt><dd><p>Windows support for compilers in <code class="docutils literal notranslate"><span class="pre">conda</span></code> is facilitated by pulling MSYS2
binaries, however these <a class="reference external" href="https://github.com/conda-forge/conda-forge.github.io/issues/1044">are outdated</a>, and therefore not recommended (as of 30-01-2022).</p>
</dd>
<dt>PGI Compilers (commercial)</dt><dd><p>Unmaintained but sufficient if an existing license is present. Works
natively, but has been superseded by the Nvidia HPC SDK, with no <a class="reference external" href="https://developer.nvidia.com/nvidia-hpc-sdk-downloads#collapseFour">native
Windows support</a>.</p>
</dd>
<dt>Cygwin (FOSS)</dt><dd><p>Can also be used for <code class="docutils literal notranslate"><span class="pre">gfortran</span></code>. However, the POSIX API compatibility layer provided by
Cygwin is meant to compile UNIX software on Windows, instead of building
native Windows programs. This means cross compilation is required.</p>
</dd>
</dl>
<p>The compilation suites described so far are compatible with the <a class="reference external" href="https://github.com/numpy/numpy/pull/20875">now
deprecated</a> <code class="docutils literal notranslate"><span class="pre">np.distutils</span></code> build backend which is exposed by the F2PY CLI.
Additional build system usage (<code class="docutils literal notranslate"><span class="pre">meson</span></code>, <code class="docutils literal notranslate"><span class="pre">cmake</span></code>) as described in
<a class="reference internal" href="../buildtools/index.html#f2py-bldsys"><span class="std std-ref">F2PY and Build Systems</span></a> allows for a more flexible set of compiler
backends including:</p>
<dl class="simple">
<dt>Intel oneAPI</dt><dd><p>The newer Intel compilers (<code class="docutils literal notranslate"><span class="pre">ifx</span></code>, <code class="docutils literal notranslate"><span class="pre">icx</span></code>) are based on LLVM and can be
used for native compilation. Licensing requirements can be onerous.</p>
</dd>
<dt>Classic Flang (FOSS)</dt><dd><p>The backbone of the PGI compilers were cannibalized to form the “classic” or
<a class="reference external" href="https://github.com/flang-compiler/flang">legacy version of Flang</a>. This may be compiled from source and used
natively. <a class="reference external" href="https://releases.llvm.org/11.0.0/tools/flang/docs/ReleaseNotes.html">LLVM Flang</a> does not support Windows yet (30-01-2022).</p>
</dd>
<dt>LFortran (FOSS)</dt><dd><p>One of two LLVM based compilers. Not all of F2PY supported Fortran can be
compiled yet (30-01-2022) but uses MSVC for native linking.</p>
</dd>
</dl>
</section>
<section id="baseline">
<h2>Baseline<a class="headerlink" href="#baseline" title="Permalink to this heading">#</a></h2>
<p>For this document we will assume the following basic tools:</p>
<ul class="simple">
<li><p>The IDE being considered is the community supported <a class="reference external" href="https://code.visualstudio.com/Download">Microsoft Visual Studio Code</a></p></li>
<li><p>The terminal being used is the <a class="reference external" href="https://www.microsoft.com/en-us/p/windows-terminal/9n0dx20hk701?activetab=pivot:overviewtab">Windows Terminal</a></p></li>
<li><p>The shell environment is assumed to be <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.1">Powershell 7.x</a></p></li>
<li><dl class="simple">
<dt>Python 3.10 from <a class="reference external" href="https://www.microsoft.com/en-us/p/python-310/9pjpw5ldxlz5">the Microsoft Store</a> and this can be tested with</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Get-Command</span> <span class="pre">python.exe</span></code> resolving to
<code class="docutils literal notranslate"><span class="pre">C:\Users\$USERNAME\AppData\Local\Microsoft\WindowsApps\python.exe</span></code></p>
</dd>
</dl>
</li>
<li><p>The Microsoft Visual C++ (MSVC) toolset</p></li>
</ul>
<p>With this baseline configuration, we will further consider a configuration
matrix as follows:</p>
<span id="table-f2py-winsup-mat"></span><table class="table" id="id1">
<caption><span class="caption-text">Support matrix, exe implies a Windows installer</span><a class="headerlink" href="#id1" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Fortran Compiler</strong></p></th>
<th class="head"><p><strong>C/C++ Compiler</strong></p></th>
<th class="head"><p><strong>Source</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Intel Fortran</p></td>
<td><p>MSVC / ICC</p></td>
<td><p>exe</p></td>
</tr>
<tr class="row-odd"><td><p>GFortran</p></td>
<td><p>MSVC</p></td>
<td><p>MSYS2/exe</p></td>
</tr>
<tr class="row-even"><td><p>GFortran</p></td>
<td><p>GCC</p></td>
<td><p>WSL</p></td>
</tr>
<tr class="row-odd"><td><p>Classic Flang</p></td>
<td><p>MSVC</p></td>
<td><p>Source / Conda</p></td>
</tr>
<tr class="row-even"><td><p>Anaconda GFortran</p></td>
<td><p>Anaconda GCC</p></td>
<td><p>exe</p></td>
</tr>
</tbody>
</table>
<p>For an understanding of the key issues motivating the need for such a matrix
<a class="reference external" href="https://pav.iki.fi/blog/2017-10-08/pywingfortran.html#building-python-wheels-with-fortran-for-windows">Pauli Virtanen’s in-depth post on wheels with Fortran for Windows</a> is an
excellent resource. An entertaining explanation of an application binary
interface (ABI) can be found in this post by <a class="reference external" href="https://thephd.dev/binary-banshees-digital-demons-abi-c-c++-help-me-god-please">JeanHeyd Meneide</a>.</p>
</section>
<section id="powershell-and-msvc">
<h2>Powershell and MSVC<a class="headerlink" href="#powershell-and-msvc" title="Permalink to this heading">#</a></h2>
<p>MSVC is installed either via the Visual Studio Bundle or the lighter (preferred)
<a class="reference external" href="https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2019">Build Tools for Visual Studio</a> with the <code class="docutils literal notranslate"><span class="pre">Desktop</span> <span class="pre">development</span> <span class="pre">with</span> <span class="pre">C++</span></code>
setting.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This can take a significant amount of time as it includes a download of around
2GB and requires a restart.</p>
</div>
<p>It is possible to use the resulting environment from a <a class="reference external" href="https://docs.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-160#developer_command_file_locations">standard command
prompt</a>. However, it is more pleasant to use a <a class="reference external" href="https://docs.microsoft.com/en-us/visualstudio/ide/reference/command-prompt-powershell?view=vs-2019">developer powershell</a>,
with a <a class="reference external" href="https://techcommunity.microsoft.com/t5/microsoft-365-pnp-blog/add-developer-powershell-and-developer-command-prompt-for-visual/ba-p/2243078">profile in Windows Terminal</a>. This can be achieved by adding the
following block to the <code class="docutils literal notranslate"><span class="pre">profiles-&gt;list</span></code> section of the JSON file used to
configure Windows Terminal (see <code class="docutils literal notranslate"><span class="pre">Settings-&gt;Open</span> <span class="pre">JSON</span> <span class="pre">file</span></code>):</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Developer PowerShell for VS 2019&quot;</span><span class="p">,</span>
<span class="nt">&quot;commandline&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;powershell.exe -noe -c \&quot;$vsPath = (Join-Path ${env:ProgramFiles(x86)} -ChildPath &#39;Microsoft Visual Studio\\2019\\BuildTools&#39;); Import-Module (Join-Path $vsPath &#39;Common7\\Tools\\Microsoft.VisualStudio.DevShell.dll&#39;); Enter-VsDevShell -VsInstallPath $vsPath -SkipAutomaticLocation\&quot;&quot;</span><span class="p">,</span>
<span class="nt">&quot;icon&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ms-appx:///ProfileIcons/{61c54bbd-c2c6-5271-96e7-009a87ff44bf}.png&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, testing the compiler toolchain could look like:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span> <span class="c"># New Windows Developer Powershell instance / tab</span>
 <span class="c"># or</span>
 <span class="nv">$vsPath</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="p">${</span><span class="n">env</span><span class="p">:</span><span class="n">ProgramFiles</span><span class="p">(</span><span class="n">x86</span><span class="p">)}</span> <span class="n">-ChildPath</span> <span class="s1">&#39;Microsoft Visual Studio\\2019\\BuildTools&#39;</span><span class="p">);</span>
 <span class="nb">Import-Module</span> <span class="p">(</span><span class="nb">Join-Path</span> <span class="nv">$vsPath</span> <span class="s1">&#39;Common7\\Tools\\Microsoft.VisualStudio.DevShell.dll&#39;</span><span class="p">);</span>
 <span class="nb">Enter-VsDevShell</span> <span class="n">-VsInstallPath</span> <span class="nv">$vsPath</span> <span class="n">-SkipAutomaticLocation</span>
 <span class="p">**********************************************************************</span>
 <span class="p">**</span> <span class="n">Visual</span> <span class="n">Studio</span> <span class="n">2019</span> <span class="n">Developer</span> <span class="n">PowerShell</span> <span class="n">v16</span><span class="p">.</span><span class="n">11</span><span class="p">.</span><span class="n">9</span>
 <span class="p">**</span> <span class="n">Copyright</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">2021</span> <span class="n">Microsoft</span> <span class="n">Corporation</span>
 <span class="p">**********************************************************************</span>
 <span class="nb">cd </span><span class="nv">$HOME</span>
 <span class="nb">echo </span><span class="s2">&quot;#include&lt;stdio.h&gt;&quot;</span> <span class="p">&gt;</span> <span class="n">blah</span><span class="p">.</span><span class="n">cpp</span><span class="p">;</span> <span class="nb">echo </span><span class="s1">&#39;int main(){printf(&quot;Hi&quot;);return 1;}&#39;</span> <span class="p">&gt;&gt;</span> <span class="n">blah</span><span class="p">.</span><span class="nb">cpp</span>
 <span class="n">cl</span> <span class="n">blah</span><span class="p">.</span><span class="nb">cpp</span>
<span class="p">.\</span><span class="n">blah</span><span class="p">.</span><span class="n">exe</span>
 <span class="c"># Hi</span>
 <span class="nb">rm </span><span class="n">blah</span><span class="p">.</span><span class="nb">cpp</span>
</pre></div>
</div>
<p>It is also possible to check that the environment has been updated correctly
with <code class="docutils literal notranslate"><span class="pre">$ENV:PATH</span></code>.</p>
</section>
<section id="windows-store-python-paths">
<h2>Windows Store Python Paths<a class="headerlink" href="#windows-store-python-paths" title="Permalink to this heading">#</a></h2>
<p>The MS Windows version of Python discussed here installs to a non-deterministic
path using a hash. This needs to be added to the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$Env:Path</span> <span class="p">+=</span> <span class="s2">&quot;;$env:LOCALAPPDATA\packages\pythonsoftwarefoundation.python.3.10_qbz5n2kfra8p0\localcache\local-packages\python310\scripts&quot;</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="intel.html">F2PY and Windows Intel Fortran</a></li>
<li class="toctree-l1"><a class="reference internal" href="msys2.html">F2PY and Windows with MSYS2</a></li>
<li class="toctree-l1"><a class="reference internal" href="conda.html">F2PY and Conda on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgi.html">F2PY and PGI Fortran on Windows</a></li>
</ul>
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../f2py-testing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">F2PY test suite</p>
      </div>
    </a>
    <a class="right-next"
       href="intel.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">F2PY and Windows Intel Fortran</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baseline">Baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#powershell-and-msvc">Powershell and MSVC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#windows-store-python-paths">Windows Store Python Paths</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2008-2022, NumPy Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>