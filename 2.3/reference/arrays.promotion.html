
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data type promotion in NumPy &#8212; NumPy v2.3 Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyterlite_sphinx.css?v=8ee2c72c" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/numpy.css?v=a1b581f7" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=ecd2caf6"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/jupyterlite_sphinx.js?v=96e329c5"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/arrays.promotion';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://numpy.org/doc/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '2.3';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Iterating over arrays" href="arrays.nditer.html" />
    <link rel="prev" title="numpy.dtype.__lt__" href="generated/numpy.dtype.__lt__.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2.3" />
    <meta name="docbuild:last-update" content="Jun 09, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/numpylogo.svg" class="logo__image only-light" alt="NumPy v2.3 Manual - Home"/>
    <img src="../_static/numpylogo_dark.svg" class="logo__image only-dark pst-js-only" alt="NumPy v2.3 Manual - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../building/index.html">
    Building from source
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../release.html">
    Release notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://numpy.org/numpy-tutorials/">
    Learn
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://numpy.org/neps">
    NEPs
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/numpy/numpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../building/index.html">
    Building from source
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../release.html">
    Release notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://numpy.org/numpy-tutorials/">
    Learn
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://numpy.org/neps">
    NEPs
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/numpy/numpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="module_structure.html">NumPy’s module structure</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="arrays.html">Array objects</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arrays.ndarray.html">The N-dimensional array (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.scalars.html">Scalars</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.dtypes.html">Data type objects (<code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data type promotion in NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.nditer.html">Iterating over arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.classes.html">Standard array subclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="maskedarray.html">Masked arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.interface.html">The array interface protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.datetime.html">Datetimes and timedeltas</a></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ufuncs.html">Universal functions (<code class="xref py py-class docutils literal notranslate"><span class="pre">ufunc</span></code>)</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="routines.html">Routines and objects by topic</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="typing.html">Typing (<code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.typing</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="distutils.html">Packaging</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="c-api/index.html">NumPy C-API</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="array_api.html">Array API standard compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="simd/index.html">CPU/SIMD optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="thread_safety.html">Thread Safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_state.html">Global Configuration Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">NumPy security</a></li>
<li class="toctree-l1"><a class="reference internal" href="distutils_status_migration.html">Status of <code class="docutils literal notranslate"><span class="pre">numpy.distutils</span></code> and migration advice</a></li>
<li class="toctree-l1"><a class="reference internal" href="distutils_guide.html"><code class="docutils literal notranslate"><span class="pre">numpy.distutils</span></code> user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="swig.html">NumPy and SWIG</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">NumPy reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="arrays.html" class="nav-link">Array objects</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Data type promotion in NumPy</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="data-type-promotion-in-numpy">
<span id="arrays-promotion"></span><h1>Data type promotion in NumPy<a class="headerlink" href="#data-type-promotion-in-numpy" title="Link to this heading">#</a></h1>
<p>When mixing two different data types, NumPy has to determine the appropriate
dtype for the result of the operation. This step is referred to as <em>promotion</em>
or <em>finding the common dtype</em>.</p>
<p>In typical cases, the user does not need to worry about the details of
promotion, since the promotion step usually ensures that the result will
either match or exceed the precision of the input.</p>
<p>For example, when the inputs are of the same dtype, the dtype of the result
matches the dtype of the inputs:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">np.int8(2)</span>
</pre></div>
</div>
<p>Mixing two different dtypes normally produces a result with the dtype of the
higher precision input:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># 64 &gt; 8</span>
<span class="go">np.int64(12)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 32 &gt; 16</span>
<span class="go">np.float32(6.0)</span>
</pre></div>
</div>
<p>In typical cases, this does not lead to surprises. However, if you work with
non-default dtypes like unsigned integers and low-precision floats, or if you
mix NumPy integers, NumPy floats, and Python scalars, some
details of NumPy promotion rules may be relevant. Note that these detailed
rules do not always match those of other languages <a class="footnote-reference brackets" href="#hist-reasons" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>Numerical dtypes come in four “kinds” with a natural hierarchy.</p>
<ol class="arabic simple">
<li><p>unsigned integers (<code class="docutils literal notranslate"><span class="pre">uint</span></code>)</p></li>
<li><p>signed integers (<code class="docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
<li><p>float (<code class="docutils literal notranslate"><span class="pre">float</span></code>)</p></li>
<li><p>complex (<code class="docutils literal notranslate"><span class="pre">complex</span></code>)</p></li>
</ol>
<p>In addition to kind, NumPy numerical dtypes also have an associated precision, specified
in bits. Together, the kind and precision specify the dtype. For example, a
<code class="docutils literal notranslate"><span class="pre">uint8</span></code> is an unsigned integer stored using 8 bits.</p>
<p>The result of an operation will always be of an equal or higher kind of any of
the inputs. Furthermore, the result will always have a precision greater than
or equal to those of the inputs. Already, this can lead to some examples which
may be unexpected:</p>
<ol class="arabic simple">
<li><p>When mixing floating point numbers and integers, the precision of the
integer may force the result to a higher precision floating point. For
example, the result of an operation involving <code class="docutils literal notranslate"><span class="pre">int64</span></code> and <code class="docutils literal notranslate"><span class="pre">float16</span></code>
is <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p></li>
<li><p>When mixing unsigned and signed integers with the same precision, the
result will have <em>higher</em> precision than either inputs. Additionally,
if one of them has 64bit precision already, no higher precision integer
is available and for example an operation involving <code class="docutils literal notranslate"><span class="pre">int64</span></code> and <code class="docutils literal notranslate"><span class="pre">uint64</span></code>
gives <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p></li>
</ol>
<p>Please see the <em class="xref py py-obj">Numerical promotion</em> section and image below for details
on both.</p>
<section id="detailed-behavior-of-python-scalars">
<h2>Detailed behavior of Python scalars<a class="headerlink" href="#detailed-behavior-of-python-scalars" title="Link to this heading">#</a></h2>
<p>Since NumPy 2.0 <a class="footnote-reference brackets" href="#nep50" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, an important point in our promotion rules is
that although operations involving two NumPy dtypes never lose precision,
operations involving a NumPy dtype and a Python scalar (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>,
or <code class="docutils literal notranslate"><span class="pre">complex</span></code>) <em>can</em> lose precision. For instance, it is probably intuitive
that the result of an operation between a Python integer and a NumPy integer
should be a NumPy integer. However, Python integers have arbitrary precision
whereas all NumPy dtypes have fixed precision, so the arbitrary precision
of Python integers cannot be preserved.</p>
<p>More generally, NumPy considers the “kind” of Python scalars, but ignores
their precision when determining the result dtype. This is often convenient.
For instance, when working with arrays of a low precision dtype, it is usually
desirable for simple operations with Python scalars to preserve the dtype.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr_float32</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_float32</span> <span class="o">+</span> <span class="mf">10.0</span>  <span class="c1"># undesirable to promote to float64</span>
<span class="go">array([11. , 12.5, 12.1], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_int16</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int16&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr_int16</span> <span class="o">+</span> <span class="mi">10</span>  <span class="c1"># undesirable to promote to int64</span>
<span class="go">array([13, 15, 17], dtype=int16)</span>
</pre></div>
</div>
<p>In both cases, the result precision is dictated by the NumPy dtype.
Because of this, <code class="docutils literal notranslate"><span class="pre">arr_float32</span> <span class="pre">+</span> <span class="pre">3.0</span></code> behaves the same as
<code class="docutils literal notranslate"><span class="pre">arr_float32</span> <span class="pre">+</span> <span class="pre">np.float32(3.0)</span></code>, and <code class="docutils literal notranslate"><span class="pre">arr_int16</span> <span class="pre">+</span> <span class="pre">10</span></code> behaves as
<code class="docutils literal notranslate"><span class="pre">arr_int16</span> <span class="pre">+</span> <span class="pre">np.int16(10.)</span></code>.</p>
<p>As another example, when mixing NumPy integers with a Python <code class="docutils literal notranslate"><span class="pre">float</span></code>
or <code class="docutils literal notranslate"><span class="pre">complex</span></code>, the result always has type <code class="docutils literal notranslate"><span class="pre">float64</span></code> or <code class="docutils literal notranslate"><span class="pre">complex128</span></code>:</p>
<blockquote>
<div><p>&gt;&gt; np.int16(1) + 1.0
np.float64(2.0)</p>
</div></blockquote>
<p>However, these rules can also lead to surprising behavior when working with
low precision dtypes.</p>
<p>First, since the Python value is converted to a NumPy one before the operation
can by performed, operations can fail with an error when the result seems
obvious. For instance, <code class="docutils literal notranslate"><span class="pre">np.int8(1)</span> <span class="pre">+</span> <span class="pre">1000</span></code> cannot continue because <code class="docutils literal notranslate"><span class="pre">1000</span></code>
exceeds the maximum value of an <code class="docutils literal notranslate"><span class="pre">int8</span></code>. When the Python scalar
cannot be coerced to the NumPy dtype, an error is raised:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1000</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">OverflowError</span>: <span class="n">Python integer 1000 out of bounds for int8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">100</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OverflowError</span>: <span class="n">Python int too large to convert to C long</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e300</span>
<span class="go">np.float32(inf)</span>
<span class="go">... RuntimeWarning: overflow encountered in cast</span>
</pre></div>
</div>
<p>Second, since the Python float or integer precision is always ignored, a low
precision NumPy scalar will keep using its lower precision unless explicitly
converted to a higher precision NumPy dtype or Python scalar (e.g. via <code class="docutils literal notranslate"><span class="pre">int()</span></code>,
<code class="docutils literal notranslate"><span class="pre">float()</span></code>, or <code class="docutils literal notranslate"><span class="pre">scalar.item()</span></code>). This lower precision may be detrimental to
some calculations or lead to incorrect results, especially in the case of integer
overflows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span>  <span class="c1"># the result exceeds the capacity of int8</span>
<span class="go">np.int8(-56)</span>
<span class="go">... RuntimeWarning: overflow encountered in scalar add</span>
</pre></div>
</div>
<p>Note that NumPy warns when overflows occur for scalars, but not for arrays;
e.g., <code class="docutils literal notranslate"><span class="pre">np.array(100,</span> <span class="pre">dtype=&quot;uint8&quot;)</span> <span class="pre">+</span> <span class="pre">100</span></code> will <em>not</em> warn.</p>
</section>
<section id="numerical-promotion">
<h2>Numerical promotion<a class="headerlink" href="#numerical-promotion" title="Link to this heading">#</a></h2>
<p>The following image shows the numerical promotion rules with the kinds
on the vertical axis and the precision on the horizontal axis.</p>
<figure class="align-center align-default">
<img alt="../_images/nep-0050-promotion-no-fonts.svg" src="../_images/nep-0050-promotion-no-fonts.svg" /></figure>
<p>The input dtype with the higher kind determines the kind of the result dtype.
The result dtype has a precision as low as possible without appearing to the
left of either input dtype in the diagram.</p>
<p>Note the following specific rules and observations:</p>
<ol class="arabic simple">
<li><p>When a Python <code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">complex</span></code> interacts with a NumPy integer
the result will be <code class="docutils literal notranslate"><span class="pre">float64</span></code> or <code class="docutils literal notranslate"><span class="pre">complex128</span></code> (yellow border).
NumPy booleans will also be cast to the default integer <a class="footnote-reference brackets" href="#default-int" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.
This is not relevant when additionally NumPy floating point values are
involved.</p></li>
<li><p>The precision is drawn such that <code class="docutils literal notranslate"><span class="pre">float16</span> <span class="pre">&lt;</span> <span class="pre">int16</span> <span class="pre">&lt;</span> <span class="pre">uint16</span></code> because
large <code class="docutils literal notranslate"><span class="pre">uint16</span></code> do not fit <code class="docutils literal notranslate"><span class="pre">int16</span></code> and large <code class="docutils literal notranslate"><span class="pre">int16</span></code> will lose precision
when stored in a <code class="docutils literal notranslate"><span class="pre">float16</span></code>.
This pattern however is broken since NumPy always considers <code class="docutils literal notranslate"><span class="pre">float64</span></code>
and <code class="docutils literal notranslate"><span class="pre">complex128</span></code> to be acceptable promotion results for any integer
value.</p></li>
<li><p>A special case is that NumPy promotes many combinations of signed and
unsigned integers to <code class="docutils literal notranslate"><span class="pre">float64</span></code>.  A higher kind is used here because no
signed integer dtype is sufficiently precise to hold a <code class="docutils literal notranslate"><span class="pre">uint64</span></code>.</p></li>
</ol>
</section>
<section id="exceptions-to-the-general-promotion-rules">
<h2>Exceptions to the general promotion rules<a class="headerlink" href="#exceptions-to-the-general-promotion-rules" title="Link to this heading">#</a></h2>
<p>In NumPy promotion refers to what specific functions do with the result and
in some cases, this means that NumPy may deviate from what the <em class="xref py py-obj">np.result_type</em>
would give.</p>
<section id="behavior-of-sum-and-prod">
<h3>Behavior of <code class="docutils literal notranslate"><span class="pre">sum</span></code> and <code class="docutils literal notranslate"><span class="pre">prod</span></code><a class="headerlink" href="#behavior-of-sum-and-prod" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">np.sum</span></code> and <code class="docutils literal notranslate"><span class="pre">np.prod</span></code> will always return the default integer type
when summing over integer values (or booleans).  This is usually an <code class="docutils literal notranslate"><span class="pre">int64</span></code>.
The reason for this is that integer summations are otherwise very likely
to overflow and give confusing results.
This rule also applies to the underlying <code class="docutils literal notranslate"><span class="pre">np.add.reduce</span></code> and
<code class="docutils literal notranslate"><span class="pre">np.multiply.reduce</span></code>.</p>
</section>
<section id="notable-behavior-with-numpy-or-python-integer-scalars">
<h3>Notable behavior with NumPy or Python integer scalars<a class="headerlink" href="#notable-behavior-with-numpy-or-python-integer-scalars" title="Link to this heading">#</a></h3>
<p>NumPy promotion refers to the result dtype and operation precision,
but the operation will sometimes dictate that result.
Division always returns floating point values and comparison always booleans.</p>
<p>This leads to what may appear as “exceptions” to the rules:</p>
<ul class="simple">
<li><p>NumPy comparisons with Python integers or mixed precision integers always
return the correct result.  The inputs will never be cast in a way which
loses precision.</p></li>
<li><p>Equality comparisons between types which cannot be promoted will be
considered all <code class="docutils literal notranslate"><span class="pre">False</span></code> (equality) or all <code class="docutils literal notranslate"><span class="pre">True</span></code> (not-equal).</p></li>
<li><p>Unary math functions like <code class="docutils literal notranslate"><span class="pre">np.sin</span></code> that always return floating point
values, accept any Python integer input by converting it to <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p></li>
<li><p>Division always returns floating point values and thus also allows divisions
between any NumPy integer with any Python integer value by casting both
to <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p></li>
</ul>
<p>In principle, some of these exceptions may make sense for other functions.
Please raise an issue if you feel this is the case.</p>
</section>
<section id="notable-behavior-with-python-builtin-type-classes">
<h3>Notable behavior with Python builtin type classes<a class="headerlink" href="#notable-behavior-with-python-builtin-type-classes" title="Link to this heading">#</a></h3>
<p>When combining Python’s builtin scalar <em>types</em> (i.e., <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>,
or <code class="docutils literal notranslate"><span class="pre">complex</span></code>, not scalar <em>values</em>), the promotion rules can appear
surprising:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="go">dtype(&#39;float32&#39;)  # The scalar value &#39;7&#39; does not impact type promotion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="go">dtype(&#39;float64&#39;)  # The *type* of the scalar value &#39;7&#39; does impact promotion</span>
<span class="go"># Similar situations happen with Python&#39;s float and complex types</span>
</pre></div>
</div>
<p>The reason for this behavior is that NumPy converts <code class="docutils literal notranslate"><span class="pre">int</span></code> to its default
integer type, and uses that type for promotion:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">dtype(&#39;int64&#39;)</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="arrays.dtypes.html#dtype-constructing-from-python-types"><span class="std std-ref">Built-in Python types</span></a> for more details.</p>
</section>
</section>
<section id="promotion-of-non-numerical-datatypes">
<h2>Promotion of non-numerical datatypes<a class="headerlink" href="#promotion-of-non-numerical-datatypes" title="Link to this heading">#</a></h2>
<p>NumPy extends the promotion to non-numerical types, although in many cases
promotion is not well defined and simply rejected.</p>
<p>The following rules apply:</p>
<ul class="simple">
<li><p>NumPy byte strings (<code class="docutils literal notranslate"><span class="pre">np.bytes_</span></code>) can be promoted to unicode strings
(<code class="docutils literal notranslate"><span class="pre">np.str_</span></code>).  However, casting the bytes to unicode will fail for
non-ascii characters.</p></li>
<li><p>For some purposes NumPy will promote almost any other datatype to strings.
This applies to array creation or concatenation.</p></li>
<li><p>The array constructors like <code class="docutils literal notranslate"><span class="pre">np.array()</span></code> will use <code class="docutils literal notranslate"><span class="pre">object</span></code> dtype when
there is no viable promotion.</p></li>
<li><p>Structured dtypes can promote when their field names and order matches.
In that case all fields are promoted individually.</p></li>
<li><p>NumPy <code class="docutils literal notranslate"><span class="pre">timedelta</span></code> can in some cases promote with integers.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of these rules are somewhat surprising, and are being considered for
change in the future. However, any backward-incompatible changes have to
be weighed against the risks of breaking existing code. Please raise an
issue if you have particular ideas about how promotion should work.</p>
</div>
</section>
<section id="details-of-promoted-dtype-instances">
<h2>Details of promoted <code class="docutils literal notranslate"><span class="pre">dtype</span></code> instances<a class="headerlink" href="#details-of-promoted-dtype-instances" title="Link to this heading">#</a></h2>
<p>The above discussion has mainly dealt with the behavior when mixing different
DType classes.
A <code class="docutils literal notranslate"><span class="pre">dtype</span></code> instance attached to an array can carry additional information
such as byte-order, metadata, string length, or exact structured dtype layout.</p>
<p>While the string length or field names of a structured dtype are important,
NumPy considers byte-order, metadata, and the exact layout of a structured
dtype as storage details.</p>
<p>During promotion NumPy does <em>not</em> take these storage details into account:</p>
<ul class="simple">
<li><p>Byte-order is converted to native byte-order.</p></li>
<li><p>Metadata attached to the dtype may or may not be preserved.</p></li>
<li><p>Resulting structured dtypes will be packed (but aligned if inputs were).</p></li>
</ul>
<p>This behaviors is the best behavior for most programs where storage details
are not relevant to the final results and where the use of incorrect byte-order
could drastically slow down evaluation.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="hist-reasons" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>To a large degree, this may just be for choices made early
on in NumPy’s predecessors.  For more details, see <a class="reference external" href="https://numpy.org/neps/nep-0050-scalar-promotion.html#nep50" title="(in NumPy Enhancement Proposals)"><span class="xref std std-ref">NEP 50</span></a>.</p>
</aside>
<aside class="footnote brackets" id="nep50" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>See also <a class="reference external" href="https://numpy.org/neps/nep-0050-scalar-promotion.html#nep50" title="(in NumPy Enhancement Proposals)"><span class="xref std std-ref">NEP 50</span></a> which changed the rules for
NumPy 2.0. Previous versions of NumPy would sometimes return higher
precision results based on the input value of Python scalars.
Further, previous versions of NumPy would typically ignore the higher
precision of NumPy scalars or 0-D arrays for promotion purposes.</p>
</aside>
<aside class="footnote brackets" id="default-int" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>The default integer is marked as <code class="docutils literal notranslate"><span class="pre">int64</span></code> in the schema
but is <code class="docutils literal notranslate"><span class="pre">int32</span></code> on 32bit platforms.  However, most modern systems are 64bit.</p>
</aside>
</aside>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="generated/numpy.dtype.__lt__.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">numpy.dtype.__lt__</p>
      </div>
    </a>
    <a class="right-next"
       href="arrays.nditer.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Iterating over arrays</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-behavior-of-python-scalars">Detailed behavior of Python scalars</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-promotion">Numerical promotion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exceptions-to-the-general-promotion-rules">Exceptions to the general promotion rules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#behavior-of-sum-and-prod">Behavior of <code class="docutils literal notranslate"><span class="pre">sum</span></code> and <code class="docutils literal notranslate"><span class="pre">prod</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-behavior-with-numpy-or-python-integer-scalars">Notable behavior with NumPy or Python integer scalars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-behavior-with-python-builtin-type-classes">Notable behavior with Python builtin type classes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#promotion-of-non-numerical-datatypes">Promotion of non-numerical datatypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#details-of-promoted-dtype-instances">Details of promoted <code class="docutils literal notranslate"><span class="pre">dtype</span></code> instances</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2008-2025, NumPy Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>